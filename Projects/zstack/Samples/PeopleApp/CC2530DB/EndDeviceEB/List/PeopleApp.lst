###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.1.10194/W32 for 8051         24/Dec/2025  16:42:21 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\Source\PeopleApp.c       #
#    Command line       =  -f C:\Users\admin\Desktop\ZStack-CC2530-Best\Proje #
#                          cts\zstack\Samples\PeopleApp\CC2530DB\..\..\..\Too #
#                          ls\CC2530DB\f8wEndev.cfg (-DCPU32MHZ               #
#                          -DROOT=__near_func -DMAC_CFG_TX_DATA_MAX=3         #
#                          -DMAC_CFG_TX_MAX=6 -DMAC_CFG_RX_MAX=3) -f          #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\Tools\ #
#                          CC2530DB\f8wConfig.cfg (-DZIGBEEPRO -DSECURE=0     #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST26=0x04000000                    #
#                          -DDEFAULT_CHANLIST25=0x02000000                    #
#                          -DDEFAULT_CHANLIST24=0x01000000                    #
#                          -DDEFAULT_CHANLIST23=0x00800000                    #
#                          -DDEFAULT_CHANLIST22=0x00400000                    #
#                          -DDEFAULT_CHANLIST21=0x00200000                    #
#                          -DDEFAULT_CHANLIST20=0x00100000                    #
#                          -DDEFAULT_CHANLIST19=0x00080000                    #
#                          -DDEFAULT_CHANLIST18=0x00040000                    #
#                          -DDEFAULT_CHANLIST17=0x00020000                    #
#                          -DDEFAULT_CHANLIST16=0x00010000                    #
#                          -DDEFAULT_CHANLIST15=0x00008000                    #
#                          -DDEFAULT_CHANLIST14=0x00004000                    #
#                          -DDEFAULT_CHANLIST13=0x00002000                    #
#                          -DDEFAULT_CHANLIST12=0x00001000                    #
#                          -DDEFAULT_CHANLIST11=0x00000800                    #
#                          -DDEFAULT_CHANLIST=DEFAULT_CHANLIST25              #
#                          -DZDAPP_CONFIG_PAN_ID=0x0006                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100)   #
#                          -DREJOIN_POLL_RATE=440 C:\Users\admin\Desktop\ZSta #
#                          ck-CC2530-Best\Projects\zstack\Samples\PeopleApp\S #
#                          ource\PeopleApp.c -D NWK_AUTO_POLL -D ZTOOL_P1 -D  #
#                          MT_TASK -D MT_SYS_FUNC -D MT_ZDO_FUNC -D           #
#                          LCD_SUPPORTED=DEBUG -D xPOWER_SAVING -lC           #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\EndDeviceEB\Lis #
#                          t\ -lA C:\Users\admin\Desktop\ZStack-CC2530-Best\P #
#                          rojects\zstack\Samples\PeopleApp\CC2530DB\EndDevic #
#                          eEB\List\ --diag_suppress Pe001,Pa010 -o           #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\EndDeviceEB\Obj #
#                          \ -e --no_code_motion --debug --core=plain         #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I C:\Users\admin\Desktop\ZSt #
#                          ack-CC2530-Best\Projects\zstack\Samples\PeopleApp\ #
#                          CC2530DB\ -I C:\Users\admin\Desktop\ZStack-CC2530- #
#                          Best\Projects\zstack\Samples\PeopleApp\CC2530DB\.. #
#                          \Source\ -I C:\Users\admin\Desktop\ZStack-CC2530-B #
#                          est\Projects\zstack\Samples\PeopleApp\CC2530DB\..\ #
#                          ..\..\ZMain\TI2530DB\ -I                           #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\hal\include\ -I                         #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\hal\target\CC2530EB\ -I                 #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\mac\include\ -I                         #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\mac\high_level\ -I                      #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\mac\low_level\srf04\ -I                 #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\mac\low_level\srf04\single_chip\ -I     #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\mt\ -I C:\Users\admin\Desktop\ZStack-CC #
#                          2530-Best\Projects\zstack\Samples\PeopleApp\CC2530 #
#                          DB\..\..\..\..\..\Components\osal\include\ -I      #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\services\saddr\ -I                      #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\services\sdata\ -I                      #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\stack\af\ -I C:\Users\admin\Desktop\ZSt #
#                          ack-CC2530-Best\Projects\zstack\Samples\PeopleApp\ #
#                          CC2530DB\..\..\..\..\..\Components\stack\nwk\ -I   #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\stack\sapi\ -I                          #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\stack\sec\ -I                           #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\stack\sys\ -I                           #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\stack\zdo\ -I                           #
#                          C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\..\..\..\..\..\ #
#                          Components\zmac\ -I C:\Users\admin\Desktop\ZStack- #
#                          CC2530-Best\Projects\zstack\Samples\PeopleApp\CC25 #
#                          30DB\..\..\..\..\..\Components\zmac\f8w\ -Ohz      #
#                          --require_prototypes                               #
#    List file          =  C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\EndDeviceEB\Lis #
#                          t\PeopleApp.lst                                    #
#    Object file        =  C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects #
#                          \zstack\Samples\PeopleApp\CC2530DB\EndDeviceEB\Obj #
#                          \PeopleApp.r51                                     #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\admin\Desktop\ZStack-CC2530-Best\Projects\zstack\Samples\PeopleApp\Source\PeopleApp.c
      1          
      2          #include "OSAL.h"
      3          #include "AF.h"
      4          #include "ZDApp.h"
      5          #include "ZDObject.h"
      6          #include "ZDProfile.h"
      7          
      8          #include "PeopleApp.h"
      9          #include "DebugTrace.h"
     10          
     11          #if !defined( WIN32 )
     12            #include "OnBoard.h"

   \                                 In  segment SFR_AN, at 0x90
   \   union <unnamed> volatile __sfr _A_P1
   \                     _A_P1:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xf4
   \   unsigned char volatile __sfr P1SEL
   \                     P1SEL:
   \   000000                DS 1

   \                                 In  segment SFR_AN, at 0xfe
   \   unsigned char volatile __sfr P1DIR
   \                     P1DIR:
   \   000000                DS 1
     13          #endif
     14          
     15          /* HAL */
     16          #include "hal_lcd.h"
     17          #include "hal_led.h"
     18          #include "hal_key.h"
     19          #include "hal_uart.h"
     20          
     21          
     22          // 协议簇定义

   \                                 In  segment XDATA_ROM_C, align 1
     23          const cId_t PeopleApp_ClusterList[PeopleApp_MAX_CLUSTERS] =
   \                     PeopleApp_ClusterList:
   \   000000   0100         DW 1
     24          {
     25            PeopleApp_CLUSTERID
     26          };
     27          

   \                                 In  segment XDATA_ROM_C, align 1
     28          const SimpleDescriptionFormat_t PeopleApp_SimpleDesc =
   \                     PeopleApp_SimpleDesc:
   \   000000   0A           DB 10
   \   000001   040F         DW 3844
   \   000003   0100         DW 1
   \   000005   00           DB 0
   \   000006   01           DB 1
   \   000007   ....         DW PeopleApp_ClusterList
   \   000009   01           DB 1
   \   00000A   ....         DW PeopleApp_ClusterList
     29          {
     30            PeopleApp_ENDPOINT,              //  int Endpoint;
     31            PeopleApp_PROFID,                //  uint16 AppProfId[2];
     32            PeopleApp_DEVICEID,              //  uint16 AppDeviceId[2];
     33            PeopleApp_DEVICE_VERSION,        //  int   AppDevVer:4;
     34            PeopleApp_FLAGS,                 //  int   AppFlags:4;
     35            PeopleApp_MAX_CLUSTERS,          //  byte  AppNumInClusters;
     36            (cId_t *)PeopleApp_ClusterList,  //  byte *pAppInClusterList;
     37            PeopleApp_MAX_CLUSTERS,          //  byte  AppNumInClusters;
     38            (cId_t *)PeopleApp_ClusterList   //  byte *pAppInClusterList;
     39          };
     40          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     41          endPointDesc_t PeopleApp_epDesc;
   \                     PeopleApp_epDesc:
   \   000000                DS 6
   \   000006                REQUIRE __INIT_XDATA_Z
     42          
     43          //TASKID初始化

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     44          byte PeopleApp_TaskID;   // Task ID for internal task/event processing
   \                     PeopleApp_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     45                                    // This variable will be received when
     46                                    // PeopleApp_Init() is called.

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     47          devStates_t PeopleApp_NwkState;
   \                     PeopleApp_NwkState:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     48          
     49          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     50          byte PeopleApp_TransID;  // This is the unique message ID (counter)
   \                     PeopleApp_TransID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     51          

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     52          afAddrType_t PeopleApp_DstAddr;
   \                     PeopleApp_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
     53          
     54          /*********************************************************************
     55           * 函数声明
     56           */
     57          void PeopleApp_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg );
     58          void PeopleApp_HandleKeys( byte shift, byte keys );
     59          void PeopleApp_MessageMSGCB( afIncomingMSGPacket_t *pckt );
     60          
     61          void  PeopleApp_Send_body_Message(void);
     62          
     63          
     64          //人体感应函数

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
     65          void PeopleApp_Init( byte task_id )
   \                     PeopleApp_Init:
     66          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
     67            PeopleApp_TaskID = task_id;
   \   000006   90....       MOV     DPTR,#PeopleApp_TaskID
   \   000009   F0           MOVX    @DPTR,A
     68            PeopleApp_NwkState = DEV_INIT;
   \   00000A   90....       MOV     DPTR,#PeopleApp_NwkState
   \   00000D   7401         MOV     A,#0x1
   \   00000F   F0           MOVX    @DPTR,A
     69            PeopleApp_TransID = 0;
   \   000010   90....       MOV     DPTR,#PeopleApp_TransID
   \   000013   E4           CLR     A
   \   000014   F0           MOVX    @DPTR,A
     70            
     71            //人体感应初始化 
     72             P1DIR&=~(0x01<<0);//设置P1.0为输入方式
   \   000015   53FEFE       ANL     0xfe,#0xfe
     73             P1SEL&=0x01;//设置P1.0为通用输入方向
   \   000018   E5F4         MOV     A,0xf4
   \   00001A   A2E0         MOV     C,0xE0 /* A   */.0
   \   00001C   E4           CLR     A
   \   00001D   33           RLC     A
   \   00001E   F5F4         MOV     0xf4,A
     74             
     75          
     76            PeopleApp_DstAddr.addrMode = (afAddrMode_t)AddrNotPresent;
   \   000020   90....       MOV     DPTR,#PeopleApp_DstAddr + 8
   \   000023   E4           CLR     A
   \   000024   F0           MOVX    @DPTR,A
     77            PeopleApp_DstAddr.endPoint = 0;
   \   000025   A3           INC     DPTR
   \   000026   F0           MOVX    @DPTR,A
     78            PeopleApp_DstAddr.addr.shortAddr = 0;
   \   000027   90....       MOV     DPTR,#PeopleApp_DstAddr
   \   00002A   F0           MOVX    @DPTR,A
   \   00002B   A3           INC     DPTR
   \   00002C   F0           MOVX    @DPTR,A
     79          
     80            // Fill out the endpoint description.
     81            PeopleApp_epDesc.endPoint = PeopleApp_ENDPOINT;
   \   00002D   90....       MOV     DPTR,#PeopleApp_epDesc
   \   000030   740A         MOV     A,#0xa
   \   000032   F0           MOVX    @DPTR,A
     82            PeopleApp_epDesc.task_id = &PeopleApp_TaskID;
   \   000033   A3           INC     DPTR
   \   000034   74..         MOV     A,#PeopleApp_TaskID & 0xff
   \   000036   F0           MOVX    @DPTR,A
   \   000037   A3           INC     DPTR
   \   000038   74..         MOV     A,#(PeopleApp_TaskID >> 8) & 0xff
   \   00003A   F0           MOVX    @DPTR,A
     83            PeopleApp_epDesc.simpleDesc
     84                      = (SimpleDescriptionFormat_t *)&PeopleApp_SimpleDesc;
   \   00003B   A3           INC     DPTR
   \   00003C   74..         MOV     A,#PeopleApp_SimpleDesc & 0xff
   \   00003E   F0           MOVX    @DPTR,A
   \   00003F   A3           INC     DPTR
   \   000040   74..         MOV     A,#(PeopleApp_SimpleDesc >> 8) & 0xff
   \   000042   F0           MOVX    @DPTR,A
     85            PeopleApp_epDesc.latencyReq = noLatencyReqs;
   \   000043   A3           INC     DPTR
   \   000044   E4           CLR     A
   \   000045   F0           MOVX    @DPTR,A
     86          
     87            // Register the endpoint description with the AF
     88            afRegister( &PeopleApp_epDesc );
   \   000046                ; Setup parameters for call to function afRegister
   \   000046   7A..         MOV     R2,#PeopleApp_epDesc & 0xff
   \   000048   7B..         MOV     R3,#(PeopleApp_epDesc >> 8) & 0xff
   \   00004A   12....       LCALL   ??afRegister?relay
     89          
     90            // Register for all key events - This app will handle all key events
     91            RegisterForKeys( PeopleApp_TaskID );
   \   00004D                ; Setup parameters for call to function RegisterForKeys
   \   00004D   90....       MOV     DPTR,#PeopleApp_TaskID
   \   000050   E0           MOVX    A,@DPTR
   \   000051   F9           MOV     R1,A
   \   000052   12....       LCALL   ??RegisterForKeys?relay
     92          
     93            // Update the display
     94          #if defined ( LCD_SUPPORTED )
     95              HalLcdWriteString( "PeopleApp", HAL_LCD_LINE_1 );
   \   000055                ; Setup parameters for call to function HalLcdWriteString
   \   000055   7901         MOV     R1,#0x1
   \   000057   7A..         MOV     R2,#`?<Constant "PeopleApp">` & 0xff
   \   000059   7B..         MOV     R3,#(`?<Constant "PeopleApp">` >> 8) & 0xff
   \   00005B   12....       LCALL   ??HalLcdWriteString?relay
     96          #endif
     97          
     98            ZDO_RegisterForZDOMsg( PeopleApp_TaskID, End_Device_Bind_rsp );
   \   00005E                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00005E   7A20         MOV     R2,#0x20
   \   000060   7B80         MOV     R3,#-0x80
   \   000062   90....       MOV     DPTR,#PeopleApp_TaskID
   \   000065   E0           MOVX    A,@DPTR
   \   000066   F9           MOV     R1,A
   \   000067   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
     99            ZDO_RegisterForZDOMsg( PeopleApp_TaskID, Match_Desc_rsp );
   \   00006A                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   00006A   7A06         MOV     R2,#0x6
   \   00006C   7B80         MOV     R3,#-0x80
   \   00006E   90....       MOV     DPTR,#PeopleApp_TaskID
   \   000071   E0           MOVX    A,@DPTR
   \   000072   F9           MOV     R1,A
   \   000073   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
    100          }
   \   000076   7F01         MOV     R7,#0x1
   \   000078   02....       LJMP    ?BANKED_LEAVE_XDATA
   \   00007B                REQUIRE P1DIR
   \   00007B                REQUIRE P1SEL
    101          
    102          //事件处理函数

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    103          UINT16 PeopleApp_ProcessEvent( byte task_id, UINT16 events )
   \                     PeopleApp_ProcessEvent:
    104          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 0
   \   000005   EA           MOV     A,R2
   \   000006   FE           MOV     R6,A
   \   000007   EB           MOV     A,R3
   \   000008   FF           MOV     R7,A
    105            afIncomingMSGPacket_t *MSGpkt;
    106            afDataConfirm_t *afDataConfirm;
    107          
    108            // Data Confirmation message fields
    109            byte sentEP;
    110            ZStatus_t sentStatus;
    111            byte sentTransID;       // This should match the value sent
    112            (void)task_id;  // Intentionally unreferenced parameter
    113          
    114            if ( events & SYS_EVENT_MSG )
   \   000009   5480         ANL     A,#0x80
   \   00000B   7003         JNZ     $+5
   \   00000D   02....       LJMP    ??PeopleApp_ProcessEvent_0 & 0xFFFF
    115            {
    116              MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( PeopleApp_TaskID );
   \   000010                ; Setup parameters for call to function osal_msg_receive
   \   000010   8038         SJMP    ??PeopleApp_ProcessEvent_1
    117              while ( MSGpkt )
    118              {
    119                switch ( MSGpkt->hdr.event )
    120                {
    121                  case ZDO_CB_MSG:
    122                    PeopleApp_ProcessZDOMsgs( (zdoIncomingMsg_t *)MSGpkt );
    123                    break;
    124          
    125                  case KEY_CHANGE:
    126                    PeopleApp_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
    127                    break;
    128          
    129                  case AF_DATA_CONFIRM_CMD:
    130                    // This message is received as a confirmation of a data packet sent.
    131                    // The status is of ZStatus_t type [defined in ZComDef.h]
    132                    // The message fields are defined in AF.h
    133                    afDataConfirm = (afDataConfirm_t *)MSGpkt;
    134                    sentEP = afDataConfirm->endpoint;
    135                    sentStatus = afDataConfirm->hdr.status;
    136                    sentTransID = afDataConfirm->transID;
    137                    (void)sentEP;
    138                    (void)sentTransID;
    139          
    140                    // Action taken when confirmation is received.
    141                    if ( sentStatus != ZSuccess )
    142                    {
    143                      // The data wasn't delivered -- Do something
    144                    }
    145                    break;
    146          
    147                  case AF_INCOMING_MSG_CMD:
    148                    PeopleApp_MessageMSGCB( MSGpkt );
    149                    break;
    150          
    151                  case ZDO_STATE_CHANGE:
    152                    PeopleApp_NwkState = (devStates_t)(MSGpkt->hdr.status);
   \                     ??PeopleApp_ProcessEvent_2:
   \   000012   A3           INC     DPTR
   \   000013   E0           MOVX    A,@DPTR
   \   000014   90....       MOV     DPTR,#PeopleApp_NwkState
   \   000017   F0           MOVX    @DPTR,A
    153                    if ( (PeopleApp_NwkState == DEV_ZB_COORD)
    154                        || (PeopleApp_NwkState == DEV_ROUTER)
    155                        || (PeopleApp_NwkState == DEV_END_DEVICE) )
   \   000018   6409         XRL     A,#0x9
   \   00001A   600A         JZ      ??PeopleApp_ProcessEvent_3
   \   00001C   E0           MOVX    A,@DPTR
   \   00001D   6407         XRL     A,#0x7
   \   00001F   6005         JZ      ??PeopleApp_ProcessEvent_3
   \   000021   E0           MOVX    A,@DPTR
   \   000022   6406         XRL     A,#0x6
   \   000024   701D         JNZ     ??PeopleApp_ProcessEvent_4
    156                    {
    157                       HalLedBlink( HAL_LED_1, 5, 50, 250 );
   \                     ??PeopleApp_ProcessEvent_3:
   \   000026                ; Setup parameters for call to function HalLedBlink
   \   000026   7CFA         MOV     R4,#-0x6
   \   000028   7D00         MOV     R5,#0x0
   \   00002A   7B32         MOV     R3,#0x32
   \   00002C   7A05         MOV     R2,#0x5
   \   00002E   7901         MOV     R1,#0x1
   \   000030   12....       LCALL   ??HalLedBlink?relay
    158                      // Start sending "the" message in a regular interval.
    159                    #if!defined(ZOD_COORDINATOR)                                //如果是终端节点那么就定时发送人体感应数据
    160                      osal_start_timerEx( PeopleApp_TaskID,
    161                                          PeopleApp_SEND_MSG_PERIODIC_BODY_EVT,
    162                                          PeopleApp_SEND_MSG_TIMEOUT ); 
   \   000033                ; Setup parameters for call to function osal_start_timerEx
   \   000033   7CD0         MOV     R4,#-0x30
   \   000035   7D07         MOV     R5,#0x7
   \   000037   7A02         MOV     R2,#0x2
   \   000039   7B00         MOV     R3,#0x0
   \   00003B   90....       MOV     DPTR,#PeopleApp_TaskID
   \   00003E   E0           MOVX    A,@DPTR
   \   00003F   F9           MOV     R1,A
   \   000040   12....       LCALL   ??osal_start_timerEx?relay
    163                    #endif  
    164                      
    165                    }
    166                    break;
    167          
    168                  default:
    169                    break;
    170                }
    171          
    172                // Release the memory
    173                osal_msg_deallocate( (uint8 *)MSGpkt );
   \                     ??PeopleApp_ProcessEvent_4:
   \   000043                ; Setup parameters for call to function osal_msg_deallocate
   \   000043   AA..         MOV     R2,?V0 + 0
   \   000045   AB..         MOV     R3,?V0 + 1
   \   000047   12....       LCALL   ??osal_msg_deallocate?relay
    174          
    175                // Next
    176                MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( PeopleApp_TaskID );
   \   00004A                ; Setup parameters for call to function osal_msg_receive
   \                     ??PeopleApp_ProcessEvent_1:
   \   00004A   90....       MOV     DPTR,#PeopleApp_TaskID
   \   00004D   E0           MOVX    A,@DPTR
   \   00004E   F9           MOV     R1,A
   \   00004F   12....       LCALL   ??osal_msg_receive?relay
   \   000052   8A..         MOV     ?V0 + 0,R2
   \   000054   8B..         MOV     ?V0 + 1,R3
   \   000056   E5..         MOV     A,?V0 + 0
   \   000058   45..         ORL     A,?V0 + 1
   \   00005A   603D         JZ      ??PeopleApp_ProcessEvent_5
   \   00005C   85..82       MOV     DPL,?V0 + 0
   \   00005F   85..83       MOV     DPH,?V0 + 1
   \   000062   E0           MOVX    A,@DPTR
   \   000063   24E6         ADD     A,#-0x1a
   \   000065   6029         JZ      ??PeopleApp_ProcessEvent_6
   \   000067   245A         ADD     A,#0x5a
   \   000069   6011         JZ      ??PeopleApp_ProcessEvent_7
   \   00006B   24EF         ADD     A,#-0x11
   \   00006D   60A3         JZ      ??PeopleApp_ProcessEvent_2
   \   00006F   24FE         ADD     A,#-0x2
   \   000071   70D0         JNZ     ??PeopleApp_ProcessEvent_4
   \   000073                ; Setup parameters for call to function PeopleApp_ProcessZDOMsgs
   \   000073   AA..         MOV     R2,?V0 + 0
   \   000075   AB..         MOV     R3,?V0 + 1
   \   000077   12....       LCALL   ??PeopleApp_ProcessZDOMsgs?relay
   \   00007A   80C7         SJMP    ??PeopleApp_ProcessEvent_4
   \                     ??PeopleApp_ProcessEvent_7:
   \   00007C                ; Setup parameters for call to function PeopleApp_HandleKeys
   \   00007C   A3           INC     DPTR
   \   00007D   A3           INC     DPTR
   \   00007E   A3           INC     DPTR
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   FA           MOV     R2,A
   \   000081   85..82       MOV     DPL,?V0 + 0
   \   000084   85..83       MOV     DPH,?V0 + 1
   \   000087   A3           INC     DPTR
   \   000088   A3           INC     DPTR
   \   000089   E0           MOVX    A,@DPTR
   \   00008A   F9           MOV     R1,A
   \   00008B   12....       LCALL   ??PeopleApp_HandleKeys?relay
   \   00008E   80B3         SJMP    ??PeopleApp_ProcessEvent_4
   \                     ??PeopleApp_ProcessEvent_6:
   \   000090                ; Setup parameters for call to function PeopleApp_MessageMSGCB
   \   000090   AA..         MOV     R2,?V0 + 0
   \   000092   AB..         MOV     R3,?V0 + 1
   \   000094   12....       LCALL   ??PeopleApp_MessageMSGCB?relay
   \   000097   80AA         SJMP    ??PeopleApp_ProcessEvent_4
    177              }
    178          
    179              // return unprocessed events
    180              return (events ^ SYS_EVENT_MSG);
   \                     ??PeopleApp_ProcessEvent_5:
   \   000099   EE           MOV     A,R6
   \   00009A   FA           MOV     R2,A
   \   00009B   EF           MOV     A,R7
   \   00009C   6480         XRL     A,#0x80
   \                     ??PeopleApp_ProcessEvent_8:
   \   00009E   FB           MOV     R3,A
   \   00009F   802C         SJMP    ??PeopleApp_ProcessEvent_9
    181            }
    182          
    183            // Send a message out - This event is generated by a timer
    184            //  (setup in PeopleApp_Init()).
    185            if ( events & PeopleApp_SEND_MSG_EVT )
   \                     ??PeopleApp_ProcessEvent_0:
   \   0000A1   EE           MOV     A,R6
   \   0000A2   A2E0         MOV     C,0xE0 /* A   */.0
   \   0000A4   5005         JNC     ??PeopleApp_ProcessEvent_10
    186            {
    187              // Send "the" message
    188             //PeopleApp_SendTheMessage();
    189          
    190              // Setup to send message again
    191              /*osal_start_timerEx( PeopleApp_TaskID,
    192                                  PeopleApp_SEND_MSG_EVT,
    193                                  PeopleApp_SEND_MSG_TIMEOUT );*/
    194          
    195              // return unprocessed events
    196              return (events ^ PeopleApp_SEND_MSG_EVT);
   \   0000A6   6401         XRL     A,#0x1
   \   0000A8   FA           MOV     R2,A
   \   0000A9   8022         SJMP    ??PeopleApp_ProcessEvent_9
    197            }
    198            
    199            if ( events & PeopleApp_SEND_MSG_PERIODIC_BODY_EVT )
   \                     ??PeopleApp_ProcessEvent_10:
   \   0000AB   5402         ANL     A,#0x2
   \   0000AD   601A         JZ      ??PeopleApp_ProcessEvent_11
    200            {
    201              
    202          
    203              
    204                PeopleApp_Send_body_Message();
   \   0000AF                ; Setup parameters for call to function PeopleApp_Send_body_Message
   \   0000AF   12....       LCALL   ??PeopleApp_Send_body_Message?relay
    205          
    206              
    207              // Setup to send message again
    208              osal_start_timerEx( PeopleApp_TaskID,
    209                                  PeopleApp_SEND_MSG_PERIODIC_BODY_EVT,
    210                                  PeopleApp_SEND_MSG_TIMEOUT );
   \   0000B2                ; Setup parameters for call to function osal_start_timerEx
   \   0000B2   7CD0         MOV     R4,#-0x30
   \   0000B4   7D07         MOV     R5,#0x7
   \   0000B6   7A02         MOV     R2,#0x2
   \   0000B8   7B00         MOV     R3,#0x0
   \   0000BA   90....       MOV     DPTR,#PeopleApp_TaskID
   \   0000BD   E0           MOVX    A,@DPTR
   \   0000BE   F9           MOV     R1,A
   \   0000BF   12....       LCALL   ??osal_start_timerEx?relay
    211          
    212              // return unprocessed events
    213              return (events ^ PeopleApp_SEND_MSG_PERIODIC_BODY_EVT);
   \   0000C2   EE           MOV     A,R6
   \   0000C3   6402         XRL     A,#0x2
   \   0000C5   FA           MOV     R2,A
   \   0000C6   EF           MOV     A,R7
   \   0000C7   80D5         SJMP    ??PeopleApp_ProcessEvent_8
    214            }
    215           
    216            
    217            
    218            return 0;
   \                     ??PeopleApp_ProcessEvent_11:
   \   0000C9   7A00         MOV     R2,#0x0
   \   0000CB   7B00         MOV     R3,#0x0
   \                     ??PeopleApp_ProcessEvent_9:
   \   0000CD                REQUIRE ?Subroutine0
   \   0000CD                ; // Fall through to label ?Subroutine0
    219          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   7F04         MOV     R7,#0x4
   \   000002   02....       LJMP    ?BANKED_LEAVE_XDATA
    220          
    221          
    222          
    223          /*********************************************************************
    224           * Event Generation Functions
    225           */
    226          
    227          /*********************************************************************
    228           * @fn      PeopleApp_ProcessZDOMsgs()
    229           *
    230           * @brief   Process response messages
    231           *
    232           * @param   none
    233           *
    234           * @return  none
    235           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    236          void PeopleApp_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg )
   \                     PeopleApp_ProcessZDOMsgs:
    237          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 0
    238            switch ( inMsg->clusterID )
   \   000005   EA           MOV     A,R2
   \   000006   240C         ADD     A,#0xc
   \   000008   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   00000B   F5..         MOV     ?V0 + 0,A
   \   00000D   A3           INC     DPTR
   \   00000E   E0           MOVX    A,@DPTR
   \   00000F   F5..         MOV     ?V0 + 1,A
   \   000011   78..         MOV     R0,#?V0 + 0
   \   000013   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for PeopleApp_ProcessZDOMsgs>_0`:
   \   000016   0000         DW        0
   \   000018   0200         DW        2
   \   00001A   0680         DW        32774
   \   00001C   ....         DW        ??PeopleApp_ProcessZDOMsgs_0
   \   00001E   2080         DW        32800
   \   000020   ....         DW        ??PeopleApp_ProcessZDOMsgs_1
   \   000022   ....         DW        ??PeopleApp_ProcessZDOMsgs_2
    239            {
    240              case End_Device_Bind_rsp:
    241                if ( ZDO_ParseBindRsp( inMsg ) == ZSuccess )
   \                     ??PeopleApp_ProcessZDOMsgs_1:
   \   000024   EA           MOV     A,R2
   \   000025   2413         ADD     A,#0x13
   \   000027   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_2:
   \   00002A   F8           MOV     R0,A
   \   00002B   A3           INC     DPTR
   \   00002C   E0           MOVX    A,@DPTR
   \   00002D   F583         MOV     DPH,A
   \   00002F   8882         MOV     DPL,R0
   \   000031   E0           MOVX    A,@DPTR
   \   000032   7009         JNZ     ??PeopleApp_ProcessZDOMsgs_3
    242                {
    243                  // Light LED
    244                  HalLedSet( HAL_LED_4, HAL_LED_MODE_ON );
   \   000034                ; Setup parameters for call to function HalLedSet
   \   000034   7A01         MOV     R2,#0x1
   \                     ??PeopleApp_ProcessZDOMsgs_4:
   \   000036   7908         MOV     R1,#0x8
   \   000038   12....       LCALL   ??HalLedSet?relay
   \   00003B   8053         SJMP    ??PeopleApp_ProcessZDOMsgs_2
    245                }
    246          #if defined( BLINK_LEDS )
    247                else
    248                {
    249                  // Flash LED to show failure
    250                  HalLedSet ( HAL_LED_4, HAL_LED_MODE_FLASH );
   \                     ??PeopleApp_ProcessZDOMsgs_3:
   \   00003D                ; Setup parameters for call to function HalLedSet
   \   00003D   7A04         MOV     R2,#0x4
   \   00003F   80F5         SJMP    ??PeopleApp_ProcessZDOMsgs_4
    251                }
    252          #endif
    253                break;
    254          
    255              case Match_Desc_rsp:
    256                {
    257                  ZDO_ActiveEndpointRsp_t *pRsp = ZDO_ParseEPListRsp( inMsg );
   \                     ??PeopleApp_ProcessZDOMsgs_0:
   \   000041                ; Setup parameters for call to function ZDO_ParseEPListRsp
   \   000041   12....       LCALL   ??ZDO_ParseEPListRsp?relay
   \   000044   8A..         MOV     ?V0 + 0,R2
   \   000046   8B..         MOV     ?V0 + 1,R3
   \   000048   AE..         MOV     R6,?V0 + 0
   \   00004A   AF..         MOV     R7,?V0 + 1
    258                  if ( pRsp )
   \   00004C   EE           MOV     A,R6
   \   00004D   4F           ORL     A,R7
   \   00004E   6040         JZ      ??PeopleApp_ProcessZDOMsgs_2
    259                  {
    260                    if ( pRsp->status == ZSuccess && pRsp->cnt )
   \   000050   8E82         MOV     DPL,R6
   \   000052   8F83         MOV     DPH,R7
   \   000054   E0           MOVX    A,@DPTR
   \   000055   7032         JNZ     ??PeopleApp_ProcessZDOMsgs_5
   \   000057   A3           INC     DPTR
   \   000058   A3           INC     DPTR
   \   000059   A3           INC     DPTR
   \   00005A   E0           MOVX    A,@DPTR
   \   00005B   602C         JZ      ??PeopleApp_ProcessZDOMsgs_5
    261                    {
    262                      PeopleApp_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;
   \   00005D   90....       MOV     DPTR,#PeopleApp_DstAddr + 8
   \   000060   7402         MOV     A,#0x2
   \   000062   F0           MOVX    @DPTR,A
    263                      PeopleApp_DstAddr.addr.shortAddr = pRsp->nwkAddr;
   \   000063   8E82         MOV     DPL,R6
   \   000065   8F83         MOV     DPH,R7
   \   000067   A3           INC     DPTR
   \   000068   E0           MOVX    A,@DPTR
   \   000069   F8           MOV     R0,A
   \   00006A   A3           INC     DPTR
   \   00006B   E0           MOVX    A,@DPTR
   \   00006C   F9           MOV     R1,A
   \   00006D   90....       MOV     DPTR,#PeopleApp_DstAddr
   \   000070   E8           MOV     A,R0
   \   000071   F0           MOVX    @DPTR,A
   \   000072   A3           INC     DPTR
   \   000073   E9           MOV     A,R1
   \   000074   F0           MOVX    @DPTR,A
    264                      // Take the first endpoint, Can be changed to search through endpoints
    265                      PeopleApp_DstAddr.endPoint = pRsp->epList[0];
   \   000075   8E82         MOV     DPL,R6
   \   000077   8F83         MOV     DPH,R7
   \   000079   A3           INC     DPTR
   \   00007A   A3           INC     DPTR
   \   00007B   A3           INC     DPTR
   \   00007C   A3           INC     DPTR
   \   00007D   E0           MOVX    A,@DPTR
   \   00007E   90....       MOV     DPTR,#PeopleApp_DstAddr + 9
   \   000081   F0           MOVX    @DPTR,A
    266          
    267                      // Light LED
    268                      HalLedSet( HAL_LED_4, HAL_LED_MODE_ON );
   \   000082                ; Setup parameters for call to function HalLedSet
   \   000082   7A01         MOV     R2,#0x1
   \   000084   7908         MOV     R1,#0x8
   \   000086   12....       LCALL   ??HalLedSet?relay
    269                    }
    270                    osal_mem_free( pRsp );
   \                     ??PeopleApp_ProcessZDOMsgs_5:
   \   000089                ; Setup parameters for call to function osal_mem_free
   \   000089   EE           MOV     A,R6
   \   00008A   FA           MOV     R2,A
   \   00008B   EF           MOV     A,R7
   \   00008C   FB           MOV     R3,A
   \   00008D   12....       LCALL   ??osal_mem_free?relay
    271                  }
    272                }
    273                break;
    274            }
    275          }
   \                     ??PeopleApp_ProcessZDOMsgs_2:
   \   000090   7F02         MOV     R7,#0x2
   \   000092   02....       LJMP    ?BANKED_LEAVE_XDATA

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   F582         MOV     DPL,A
   \   000002   EB           MOV     A,R3
   \   000003                REQUIRE ??Subroutine2_0
   \   000003                ; // Fall through to label ??Subroutine2_0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ??Subroutine2_0:
   \   000000   3400         ADDC    A,#0x0
   \   000002   F583         MOV     DPH,A
   \   000004   E0           MOVX    A,@DPTR
   \   000005   22           RET
    276          
    277          /*********************************************************************
    278           * @fn      PeopleApp_HandleKeys
    279           *
    280           * @brief   Handles all key events for this device.
    281           *
    282           * @param   shift - true if in shift/alt.
    283           * @param   keys - bit field for key events. Valid entries:
    284           *                 HAL_KEY_SW_4
    285           *                 HAL_KEY_SW_3
    286           *                 HAL_KEY_SW_2
    287           *                 HAL_KEY_SW_1
    288           *
    289           * @return  none
    290           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    291          void PeopleApp_HandleKeys( byte shift, byte keys )
   \                     PeopleApp_HandleKeys:
    292          {
   \   000000   74F5         MOV     A,#-0xb
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 11
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   E9           MOV     A,R1
   \   00000B   FE           MOV     R6,A
   \   00000C   EA           MOV     A,R2
   \   00000D   FF           MOV     R7,A
    293            zAddrType_t dstAddr;
    294          
    295            // Shift is used to make each button/switch dual purpose.
    296            if ( shift )
   \   00000E   EE           MOV     A,R6
   \   00000F   6003         JZ      $+5
   \   000011   02....       LJMP    ??PeopleApp_HandleKeys_0 & 0xFFFF
    297            {
    298              if ( keys & HAL_KEY_SW_1 )
    299              {
    300              }
    301              if ( keys & HAL_KEY_SW_2 )
    302              {
    303              }
    304              if ( keys & HAL_KEY_SW_3 )
    305              {
    306              }
    307              if ( keys & HAL_KEY_SW_4 )
    308              {
    309              }
    310            }
    311            else
    312            {
    313              if ( keys & HAL_KEY_SW_1 )
    314              {
    315                // Since SW1 isn't used for anything else in this application...
    316          #if defined( SWITCH1_BIND )
    317                // we can use SW1 to simulate SW2 for devices that only have one switch,
    318                keys |= HAL_KEY_SW_2;
    319          #elif defined( SWITCH1_MATCH )
    320                // or use SW1 to simulate SW4 for devices that only have one switch
    321                keys |= HAL_KEY_SW_4;
    322          #endif
    323              }
    324          
    325              if ( keys & HAL_KEY_SW_2 )
   \   000014   EF           MOV     A,R7
   \   000015   A2E1         MOV     C,0xE0 /* A   */.1
   \   000017   506D         JNC     ??PeopleApp_HandleKeys_1
    326              {
    327                HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF );
   \   000019                ; Setup parameters for call to function HalLedSet
   \   000019   7A00         MOV     R2,#0x0
   \   00001B   7908         MOV     R1,#0x8
   \   00001D   12....       LCALL   ??HalLedSet?relay
    328          
    329                // Initiate an End Device Bind Request for the mandatory endpoint
    330                dstAddr.addrMode = Addr16Bit;
   \   000020   7408         MOV     A,#0x8
   \   000022   12....       LCALL   ?XSTACK_DISP0_8
   \   000025   7402         MOV     A,#0x2
   \   000027   F0           MOVX    @DPTR,A
    331                dstAddr.addr.shortAddr = 0x0000; // Coordinator
   \   000028   85..82       MOV     DPL,?XSP + 0
   \   00002B   85..83       MOV     DPH,?XSP + 1
   \   00002E   E4           CLR     A
   \   00002F   F0           MOVX    @DPTR,A
   \   000030   A3           INC     DPTR
   \   000031   F0           MOVX    @DPTR,A
    332                ZDP_EndDeviceBindReq( &dstAddr, NLME_GetShortAddr(),
    333                                      PeopleApp_epDesc.endPoint,
    334                                      PeopleApp_PROFID,
    335                                      PeopleApp_MAX_CLUSTERS, (cId_t *)PeopleApp_ClusterList,
    336                                      PeopleApp_MAX_CLUSTERS, (cId_t *)PeopleApp_ClusterList,
    337                                      FALSE );
   \   000032                ; Setup parameters for call to function NLME_GetShortAddr
   \   000032   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000035   8A..         MOV     ?V0 + 0,R2
   \   000037   8B..         MOV     ?V0 + 1,R3
   \   000039   AC..         MOV     R4,?V0 + 0
   \   00003B   AD..         MOV     R5,?V0 + 1
   \   00003D   75....       MOV     ?V0 + 0,#PeopleApp_ClusterList & 0xff
   \   000040   75....       MOV     ?V0 + 1,#(PeopleApp_ClusterList >> 8) & 0xff
   \   000043                ; Setup parameters for call to function ZDP_EndDeviceBindReq
   \   000043   75..00       MOV     ?V0 + 2,#0x0
   \   000046   78..         MOV     R0,#?V0 + 2
   \   000048   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00004B   78..         MOV     R0,#?V0 + 0
   \   00004D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000050   75..01       MOV     ?V0 + 2,#0x1
   \   000053   78..         MOV     R0,#?V0 + 2
   \   000055   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000058   78..         MOV     R0,#?V0 + 0
   \   00005A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00005D   75..01       MOV     ?V0 + 0,#0x1
   \   000060   78..         MOV     R0,#?V0 + 0
   \   000062   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000065   75..04       MOV     ?V0 + 0,#0x4
   \   000068   75..0F       MOV     ?V0 + 1,#0xf
   \   00006B   78..         MOV     R0,#?V0 + 0
   \   00006D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000070   90....       MOV     DPTR,#PeopleApp_epDesc
   \   000073   E0           MOVX    A,@DPTR
   \   000074   F9           MOV     R1,A
   \   000075   7409         MOV     A,#0x9
   \   000077   12....       LCALL   ?XSTACK_DISP0_8
   \   00007A   AA82         MOV     R2,DPL
   \   00007C   AB83         MOV     R3,DPH
   \   00007E   12....       LCALL   ??ZDP_EndDeviceBindReq?relay
   \   000081   7409         MOV     A,#0x9
   \   000083   12....       LCALL   ?DEALLOC_XSTACK8
    338              }
    339          
    340              if ( keys & HAL_KEY_SW_3 )
    341              {
    342              }
    343          
    344              if ( keys & HAL_KEY_SW_4 )
   \                     ??PeopleApp_HandleKeys_1:
   \   000086   EF           MOV     A,R7
   \   000087   A2E3         MOV     C,0xE0 /* A   */.3
   \   000089   505C         JNC     ??PeopleApp_HandleKeys_0
    345              {
    346                HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF );
   \   00008B                ; Setup parameters for call to function HalLedSet
   \   00008B   7A00         MOV     R2,#0x0
   \   00008D   7908         MOV     R1,#0x8
   \   00008F   12....       LCALL   ??HalLedSet?relay
    347                // Initiate a Match Description Request (Service Discovery)
    348                dstAddr.addrMode = AddrBroadcast;
   \   000092   7408         MOV     A,#0x8
   \   000094   12....       LCALL   ?XSTACK_DISP0_8
   \   000097   740F         MOV     A,#0xf
   \   000099   F0           MOVX    @DPTR,A
    349                dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR;
   \   00009A   85..82       MOV     DPL,?XSP + 0
   \   00009D   85..83       MOV     DPH,?XSP + 1
   \   0000A0   74FF         MOV     A,#-0x1
   \   0000A2   F0           MOVX    @DPTR,A
   \   0000A3   A3           INC     DPTR
   \   0000A4   F0           MOVX    @DPTR,A
    350                ZDP_MatchDescReq( &dstAddr, NWK_BROADCAST_SHORTADDR,
    351                                  PeopleApp_PROFID,
    352                                  PeopleApp_MAX_CLUSTERS, (cId_t *)PeopleApp_ClusterList,
    353                                  PeopleApp_MAX_CLUSTERS, (cId_t *)PeopleApp_ClusterList,
    354                                  FALSE );
   \   0000A5   75....       MOV     ?V0 + 0,#PeopleApp_ClusterList & 0xff
   \   0000A8   75....       MOV     ?V0 + 1,#(PeopleApp_ClusterList >> 8) & 0xff
   \   0000AB                ; Setup parameters for call to function ZDP_MatchDescReq
   \   0000AB   75..00       MOV     ?V0 + 2,#0x0
   \   0000AE   78..         MOV     R0,#?V0 + 2
   \   0000B0   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000B3   78..         MOV     R0,#?V0 + 0
   \   0000B5   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000B8   75..01       MOV     ?V0 + 2,#0x1
   \   0000BB   78..         MOV     R0,#?V0 + 2
   \   0000BD   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000C0   78..         MOV     R0,#?V0 + 0
   \   0000C2   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000C5   75..04       MOV     ?V0 + 0,#0x4
   \   0000C8   75..0F       MOV     ?V0 + 1,#0xf
   \   0000CB   78..         MOV     R0,#?V0 + 0
   \   0000CD   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000D0   7901         MOV     R1,#0x1
   \   0000D2   7CFF         MOV     R4,#-0x1
   \   0000D4   7DFF         MOV     R5,#-0x1
   \   0000D6   7408         MOV     A,#0x8
   \   0000D8   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DB   AA82         MOV     R2,DPL
   \   0000DD   AB83         MOV     R3,DPH
   \   0000DF   12....       LCALL   ??ZDP_MatchDescReq?relay
   \   0000E2   7408         MOV     A,#0x8
   \   0000E4   12....       LCALL   ?DEALLOC_XSTACK8
    355              }
    356            }
    357          }
   \                     ??PeopleApp_HandleKeys_0:
   \   0000E7   7409         MOV     A,#0x9
   \   0000E9   12....       LCALL   ?DEALLOC_XSTACK8
   \   0000EC   7F03         MOV     R7,#0x3
   \   0000EE   02....       LJMP    ?BANKED_LEAVE_XDATA
    358          
    359          /*********************************************************************
    360           * LOCAL FUNCTIONS
    361           */
    362          
    363          /*********************************************************************
    364           * @fn      PeopleApp_MessageMSGCB
    365           *
    366           * @brief   Data message processor callback.  This function processes
    367           *          any incoming data - probably from other devices.  So, based
    368           *          on cluster ID, perform the intended action.
    369           *
    370           * @param   none
    371           *
    372           * @return  none
    373           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    374          void PeopleApp_MessageMSGCB( afIncomingMSGPacket_t *pkt )
   \                     PeopleApp_MessageMSGCB:
    375          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    376            switch ( pkt->clusterId )
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   A3           INC     DPTR
   \   00000B   A3           INC     DPTR
   \   00000C   E0           MOVX    A,@DPTR
   \   00000D   6401         XRL     A,#0x1
   \   00000F   7002         JNZ     ??PeopleApp_MessageMSGCB_0
   \   000011   A3           INC     DPTR
   \   000012   E0           MOVX    A,@DPTR
   \                     ??PeopleApp_MessageMSGCB_0:
   \   000013   7011         JNZ     ??PeopleApp_MessageMSGCB_1
    377            {
    378              case PeopleApp_CLUSTERID:
    379                // "the" message
    380          #if defined( LCD_SUPPORTED )
    381                HalLcdWriteScreen( (char*)pkt->cmd.Data, "rcvd" );
   \   000015                ; Setup parameters for call to function HalLcdWriteScreen
   \   000015   7C..         MOV     R4,#`?<Constant "rcvd">` & 0xff
   \   000017   7D..         MOV     R5,#(`?<Constant "rcvd">` >> 8) & 0xff
   \   000019   EA           MOV     A,R2
   \   00001A   2422         ADD     A,#0x22
   \   00001C   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   00001F   FA           MOV     R2,A
   \   000020   A3           INC     DPTR
   \   000021   E0           MOVX    A,@DPTR
   \   000022   FB           MOV     R3,A
   \   000023   12....       LCALL   ??HalLcdWriteScreen?relay
    382          #elif defined( WIN32 )
    383                WPRINTSTR( pkt->cmd.Data );
    384          #endif
    385                break;
    386            }
    387          }
   \                     ??PeopleApp_MessageMSGCB_1:
   \   000026   D083         POP     DPH
   \   000028   D082         POP     DPL
   \   00002A   02....       LJMP    ?BRET
    388          
    389          /*********************************************************************
    390           * @fn      PeopleApp_SendTheMessage
    391           *
    392           * @brief   Send "the" message.
    393           *
    394           * @param   none
    395           *
    396           * @return  none
    397           */
    398          
    399          /*********************************************************************
    400          *********************************************************************/

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    401          void  PeopleApp_Send_body_Message(void)
   \                     PeopleApp_Send_body_Message:
    402          {
   \   000000   74F4         MOV     A,#-0xc
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 12
   \   000005                ; Auto size: 44
   \   000005   74D4         MOV     A,#-0x2c
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
    403                 // 1. 定义数据帧数组（帧结构：帧头1 + 长度1 + 类型1 + 序号1 + 业务数据N + 校验1）
    404              uint8 txFrame[32]; // 分配足够空间
    405              uint8 i = 0;       // 数组索引
    406              uint8 checkSum = 0;
   \   00000A   75..00       MOV     ?V0 + 0,#0x0
    407              static uint8 frameSeq = 0; // 静态变量保存帧序号，实现循环累加
    408          
    409              // 1. 动态获取网络地址 (注意：这些函数在设备入网后才能返回有效值)
    410              uint16 myShortAddr = NLME_GetShortAddr();          // 本节点短地址
   \   00000D                ; Setup parameters for call to function NLME_GetShortAddr
   \   00000D   12....       LCALL   ??NLME_GetShortAddr?relay
   \   000010   8A..         MOV     ?V0 + 2,R2
   \   000012   8B..         MOV     ?V0 + 3,R3
    411              uint16 parentShortAddr = NLME_GetCoordShortAddr(); // 父节点短地址
   \   000014                ; Setup parameters for call to function NLME_GetCoordShortAddr
   \   000014   12....       LCALL   ??NLME_GetCoordShortAddr?relay
    412          
    413          
    414          
    415              // 2. 构建固定帧头部分
    416              txFrame[i++] = 0xAA;           // 帧头固定为0xAA
   \   000017   85..82       MOV     DPL,?XSP + 0
   \   00001A   85..83       MOV     DPH,?XSP + 1
   \   00001D   74AA         MOV     A,#-0x56
   \   00001F   F0           MOVX    @DPTR,A
    417              txFrame[i++] = 0x00;           // 位置1：帧长度字节，先填0，最后计算
   \   000020   7401         MOV     A,#0x1
   \   000022   12....       LCALL   ?XSTACK_DISP0_8
   \   000025   E4           CLR     A
   \   000026   F0           MOVX    @DPTR,A
    418              txFrame[i++] = 0x02;           // 位置2：帧类型，0x02=无线传感数据
   \   000027   7402         MOV     A,#0x2
   \   000029   12....       LCALL   ?XSTACK_DISP0_8
   \   00002C   7402         MOV     A,#0x2
   \   00002E   F0           MOVX    @DPTR,A
    419              txFrame[i++] = frameSeq++;     // 位置3：帧序号，每次发送后自增
   \   00002F   90....       MOV     DPTR,#??frameSeq
   \   000032   E0           MOVX    A,@DPTR
   \   000033   C0E0         PUSH    A
   \   000035   7403         MOV     A,#0x3
   \   000037   12....       LCALL   ?XSTACK_DISP0_8
   \   00003A   D0E0         POP     A
   \   00003C   F0           MOVX    @DPTR,A
   \   00003D   90....       MOV     DPTR,#??frameSeq
   \   000040   E0           MOVX    A,@DPTR
   \   000041   04           INC     A
   \   000042   F0           MOVX    @DPTR,A
    420              
    421              // 3. 构建业务数据部分（命令类型: 0x03=上传传感器信息到路由）
    422              txFrame[i++] = 0x03;           // 位置4：命令类型
   \   000043   7404         MOV     A,#0x4
   \   000045   12....       LCALL   ?XSTACK_DISP0_8
   \   000048   7403         MOV     A,#0x3
   \   00004A   F0           MOVX    @DPTR,A
    423              txFrame[i++] = 0x01;           // 位置5：协议类型，0x01=Zigbee
   \   00004B   7405         MOV     A,#0x5
   \   00004D   12....       LCALL   ?XSTACK_DISP0_8
   \   000050   7401         MOV     A,#0x1
   \   000052   F0           MOVX    @DPTR,A
    424              
    425              // 传感器类型：人体感应 = 0x0006
    426              txFrame[i++] = 0x00;           // 位置6：传感器类型高字节
   \   000053   7406         MOV     A,#0x6
   \   000055   12....       LCALL   ?XSTACK_DISP0_8
   \   000058   E4           CLR     A
   \   000059   F0           MOVX    @DPTR,A
    427              txFrame[i++] = 0x06;           // 位置7：传感器类型低字节
   \   00005A   7407         MOV     A,#0x7
   \   00005C   12....       LCALL   ?XSTACK_DISP0_8
   \   00005F   7406         MOV     A,#0x6
   \   000061   F0           MOVX    @DPTR,A
    428              
    429              txFrame[i++] = 0x00;           // 位置8：索引号，默认为0
   \   000062   7408         MOV     A,#0x8
   \   000064   12....       LCALL   ?XSTACK_DISP0_8
   \   000067   E4           CLR     A
   \   000068   F0           MOVX    @DPTR,A
    430          
    431              // 4. 填入动态获取的网络地址 (注意Zigbee通常使用大端格式)
    432              // 源地址 (本节点地址)
    433             txFrame[i++] = HI_UINT16(myShortAddr);      // 位置9：源地址高字节
   \   000069   7409         MOV     A,#0x9
   \   00006B   12....       LCALL   ?XSTACK_DISP0_8
   \   00006E   E5..         MOV     A,?V0 + 3
   \   000070   F0           MOVX    @DPTR,A
    434              txFrame[i++] = LO_UINT16(myShortAddr);      // 位置10：源地址低字节
   \   000071   740A         MOV     A,#0xa
   \   000073   12....       LCALL   ?XSTACK_DISP0_8
   \   000076   E5..         MOV     A,?V0 + 2
   \   000078   F0           MOVX    @DPTR,A
    435              // 父地址
    436              txFrame[i++] = HI_UINT16(parentShortAddr);  // 位置11：父地址高字节
   \   000079   740B         MOV     A,#0xb
   \   00007B   12....       LCALL   ?XSTACK_DISP0_8
   \   00007E   EB           MOV     A,R3
   \   00007F   F0           MOVX    @DPTR,A
    437              txFrame[i++] = LO_UINT16(parentShortAddr);  // 位置12：父地址低字节
   \   000080   740C         MOV     A,#0xc
   \   000082   12....       LCALL   ?XSTACK_DISP0_8
   \   000085   EA           MOV     A,R2
   \   000086   F0           MOVX    @DPTR,A
    438          
    439              // 5. 节点类型 (人体感应是终端节点，应为 0x02)
    440              txFrame[i++] = 0x02;               // 位置13：节点类型
   \   000087   740D         MOV     A,#0xd
   \   000089   12....       LCALL   ?XSTACK_DISP0_8
   \   00008C   7402         MOV     A,#0x2
   \   00008E   F0           MOVX    @DPTR,A
    441          
    442              // 6. 值类型与数据值
    443              txFrame[i++] = 0x01;               // 位置14：值类型: 布尔型
   \   00008F   740E         MOV     A,#0xe
   \   000091   12....       LCALL   ?XSTACK_DISP0_8
   \   000094   7401         MOV     A,#0x1
   \   000096   F0           MOVX    @DPTR,A
    444          
    445              // 读取传感器状态
    446              if (P1_0 == 0) {
   \   000097   A290         MOV     C,0x90.0
   \   000099   740F         MOV     A,#0xf
   \   00009B   4007         JC      ??PeopleApp_Send_body_Message_0
    447                  txFrame[i++] = 0x01;           // 位置15：数据值，有人
   \   00009D   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A0   7401         MOV     A,#0x1
   \   0000A2   8004         SJMP    ??PeopleApp_Send_body_Message_1
    448              } else {
    449                  txFrame[i++] = 0x00;           // 位置15：数据值，无人
   \                     ??PeopleApp_Send_body_Message_0:
   \   0000A4   12....       LCALL   ?XSTACK_DISP0_8
   \   0000A7   E4           CLR     A
   \                     ??PeopleApp_Send_body_Message_1:
   \   0000A8   F0           MOVX    @DPTR,A
    450              }
    451          
    452              // 7. 重新计算帧长度 (此时i=16，表示已有16个字节)
    453              //    总帧长 = 当前字节数(16) + 1个校验码字节 = 17 (0x11)
    454              txFrame[1] = i + 1;                // 回填帧长度
   \   0000A9   7401         MOV     A,#0x1
   \   0000AB   12....       LCALL   ?XSTACK_DISP0_8
   \   0000AE   7411         MOV     A,#0x11
   \   0000B0   F0           MOVX    @DPTR,A
    455          
    456              // 8. 计算校验和
    457              for (uint8 j = 0; j < i; j++) {
   \   0000B1   7800         MOV     R0,#0x0
    458                  checkSum += txFrame[j];
   \                     ??PeopleApp_Send_body_Message_2:
   \   0000B3   88..         MOV     ?V0 + 2,R0
   \   0000B5   85..82       MOV     DPL,?XSP + 0
   \   0000B8   85..83       MOV     DPH,?XSP + 1
   \   0000BB   E582         MOV     A,DPL
   \   0000BD   25..         ADD     A,?V0 + 2
   \   0000BF   F582         MOV     DPL,A
   \   0000C1   E583         MOV     A,DPH
   \   0000C3   12....       LCALL   ??Subroutine2_0 & 0xFFFF
    459              }
   \                     ??CrossCallReturnLabel_0:
   \   0000C6   25..         ADD     A,?V0 + 0
   \   0000C8   F5..         MOV     ?V0 + 0,A
   \   0000CA   08           INC     R0
   \   0000CB   E8           MOV     A,R0
   \   0000CC   C3           CLR     C
   \   0000CD   9410         SUBB    A,#0x10
   \   0000CF   40E2         JC      ??PeopleApp_Send_body_Message_2
    460              txFrame[i++] = checkSum;           // 位置16：校验码
   \   0000D1   7410         MOV     A,#0x10
   \   0000D3   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D6   E5..         MOV     A,?V0 + 0
   \   0000D8   F0           MOVX    @DPTR,A
    461          
    462              // 7. 发送数据帧
    463                afAddrType_t    PeopleApp_Send_body_dstAddr;
    464                PeopleApp_Send_body_dstAddr.addrMode =(afAddrMode_t)afAddr16Bit;
   \   0000D9   7428         MOV     A,#0x28
   \   0000DB   12....       LCALL   ?XSTACK_DISP0_8
   \   0000DE   7402         MOV     A,#0x2
   \   0000E0   F0           MOVX    @DPTR,A
    465                PeopleApp_Send_body_dstAddr.endPoint=PeopleApp_ENDPOINT;
   \   0000E1   7429         MOV     A,#0x29
   \   0000E3   12....       LCALL   ?XSTACK_DISP0_8
   \   0000E6   740A         MOV     A,#0xa
   \   0000E8   F0           MOVX    @DPTR,A
    466                PeopleApp_Send_body_dstAddr.addr.shortAddr = 0x0000; // 目标地址：协调器
   \   0000E9   7420         MOV     A,#0x20
   \   0000EB   12....       LCALL   ?XSTACK_DISP0_8
   \   0000EE   E4           CLR     A
   \   0000EF   F0           MOVX    @DPTR,A
   \   0000F0   A3           INC     DPTR
   \   0000F1   F0           MOVX    @DPTR,A
    467          
    468          
    469           if ( AF_DataRequest(&PeopleApp_Send_body_dstAddr,
    470                             &PeopleApp_epDesc,
    471                            PeopleApp_CLUSTERID, // 确保在PeopleApp.h中已定义了该簇ID,这里定义的簇ID是为了在协调器接收到消息后，在接收数据处理的时候根据数据包的簇ID来选择对应的处理.需要注意的就是协调器接收到该节点发来的数据后需要在协调器的app.h文件里面定义该簇ID并且能有对应的处理
    472                             i,       // 发送的总字节数
    473                             txFrame, // 数据帧数组
    474                             &PeopleApp_TransID,  //用于标识本次传输的唯一序列号，不过一般不用管，它是全局变量在app初始化的时候已经赋值为0了
    475                             AF_DISCV_ROUTE,
    476                             AF_DEFAULT_RADIUS ) == afStatus_SUCCESS)
   \   0000F2                ; Setup parameters for call to function AF_DataRequest
   \   0000F2   75..1E       MOV     ?V0 + 0,#0x1e
   \   0000F5   78..         MOV     R0,#?V0 + 0
   \   0000F7   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000FA   75....       MOV     ?V0 + 0,#PeopleApp_TransID & 0xff
   \   0000FD   75....       MOV     ?V0 + 1,#(PeopleApp_TransID >> 8) & 0xff
   \   000100   78..         MOV     R0,#?V0 + 0
   \   000102   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000105   7403         MOV     A,#0x3
   \   000107   12....       LCALL   ?XSTACK_DISP0_8
   \   00010A   8582..       MOV     ?V0 + 0,DPL
   \   00010D   8583..       MOV     ?V0 + 1,DPH
   \   000110   78..         MOV     R0,#?V0 + 0
   \   000112   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000115   75..11       MOV     ?V0 + 0,#0x11
   \   000118   75..00       MOV     ?V0 + 1,#0x0
   \   00011B   78..         MOV     R0,#?V0 + 0
   \   00011D   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000120   75..01       MOV     ?V0 + 0,#0x1
   \   000123   78..         MOV     R0,#?V0 + 0
   \   000125   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000128   7920         MOV     R1,#0x20
   \   00012A   7C..         MOV     R4,#PeopleApp_epDesc & 0xff
   \   00012C   7D..         MOV     R5,#(PeopleApp_epDesc >> 8) & 0xff
   \   00012E   7429         MOV     A,#0x29
   \   000130   12....       LCALL   ?XSTACK_DISP0_8
   \   000133   AA82         MOV     R2,DPL
   \   000135   AB83         MOV     R3,DPH
   \   000137   12....       LCALL   ??AF_DataRequest?relay
   \   00013A   7409         MOV     A,#0x9
   \   00013C   12....       LCALL   ?DEALLOC_XSTACK8
   \   00013F   E9           MOV     A,R1
   \   000140   700F         JNZ     ??PeopleApp_Send_body_Message_3
    477            {
    478              // 发送成功后闪烁 data灯
    479               
    480                HalLedBlink( HAL_LED_1, 5, 50, 250 );//人体亮5次
   \   000142                ; Setup parameters for call to function HalLedBlink
   \   000142   7CFA         MOV     R4,#-0x6
   \   000144   7D00         MOV     R5,#0x0
   \   000146   7B32         MOV     R3,#0x32
   \   000148   7A05         MOV     R2,#0x5
   \   00014A   7901         MOV     R1,#0x1
   \   00014C   12....       LCALL   ??HalLedBlink?relay
   \   00014F   8007         SJMP    ??PeopleApp_Send_body_Message_4
    481            }
    482            else
    483            {
    484                  HalLedSet( HAL_LED_2, HAL_LED_MODE_ON );
   \                     ??PeopleApp_Send_body_Message_3:
   \   000151                ; Setup parameters for call to function HalLedSet
   \   000151   7A01         MOV     R2,#0x1
   \   000153   7902         MOV     R1,#0x2
   \   000155   12....       LCALL   ??HalLedSet?relay
    485                   
    486            }
    487          
    488          }
   \                     ??PeopleApp_Send_body_Message_4:
   \   000158   742C         MOV     A,#0x2c
   \   00015A   12....       LCALL   ?DEALLOC_XSTACK8
   \   00015D   02....       LJMP    ?Subroutine0 & 0xFFFF
   \   000160                REQUIRE _A_P1

   \                                 In  segment XDATA_Z, align 1, keep-with-next
   \                     ??frameSeq:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PeopleApp_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PeopleApp_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PeopleApp_ProcessEvent?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PeopleApp_ProcessEvent

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PeopleApp_ProcessZDOMsgs?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PeopleApp_ProcessZDOMsgs

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PeopleApp_HandleKeys?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PeopleApp_HandleKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PeopleApp_MessageMSGCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PeopleApp_MessageMSGCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??PeopleApp_Send_body_Message?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    PeopleApp_Send_body_Message

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "PeopleApp">`:
   \   000000   50656F70     DB "PeopleApp"
   \            6C654170
   \            7000    

   \                                 In  segment XDATA_ROM_C, align 1
   \                     `?<Constant "rcvd">`:
   \   000000   72637664     DB "rcvd"
   \            00      
    489          
    490          
    491          
    492          
    493          
    494          
    495          
    496          
    497          
    498          
    499          
    500          
    501          
    502          
    503          
    504          
    505          
    506          
    507          
    508          
    509          
    510          
    511          
    512          
    513          
    514          
    515          
    516          

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     PeopleApp_HandleKeys               0      0     41
       -> HalLedSet                     0      0     40
       -> NLME_GetShortAddr             0      0     40
       -> ZDP_EndDeviceBindReq          0      0     58
       -> HalLedSet                     0      0     40
       -> ZDP_MatchDescReq              0      0     56
     PeopleApp_Init                     0      0      9
       -> afRegister                    0      0     18
       -> RegisterForKeys               0      0     18
       -> HalLcdWriteString             0      0     18
       -> ZDO_RegisterForZDOMsg         0      0     18
       -> ZDO_RegisterForZDOMsg         0      0     18
     PeopleApp_MessageMSGCB             2      0     12
       -> HalLcdWriteScreen             4      0      0
     PeopleApp_ProcessEvent             0      0     12
       -> osal_msg_receive              0      0     24
       -> HalLedBlink                   0      0     24
       -> osal_start_timerEx            0      0     24
       -> osal_msg_deallocate           0      0     24
       -> osal_msg_receive              0      0     24
       -> PeopleApp_ProcessZDOMsgs      0      0     24
       -> PeopleApp_HandleKeys          0      0     24
       -> PeopleApp_MessageMSGCB        0      0     24
       -> PeopleApp_Send_body_Message
                                        0      0     24
       -> osal_start_timerEx            0      0     24
     PeopleApp_ProcessZDOMsgs           0      0     22
       -> HalLedSet                     0      0     20
       -> HalLedSet                     0      0     20
       -> ZDO_ParseEPListRsp            0      0     20
       -> HalLedSet                     0      0     20
       -> osal_mem_free                 0      0     20
     PeopleApp_Send_body_Message        1      0     77
       -> NLME_GetShortAddr             0      0    112
       -> NLME_GetCoordShortAddr        0      0    112
       -> AF_DataRequest                0      0    130
       -> HalLedBlink                   0      0    112
       -> HalLedSet                     0      0    112


   Segment part sizes:

     Function/Label                      Bytes
     --------------                      -----
     _A_P1                                  1
     P1SEL                                  1
     P1DIR                                  1
     PeopleApp_ClusterList                  2
     PeopleApp_SimpleDesc                  12
     PeopleApp_epDesc                       6
     PeopleApp_TaskID                       1
     PeopleApp_NwkState                     1
     PeopleApp_TransID                      1
     PeopleApp_DstAddr                     12
     PeopleApp_Init                       123
     PeopleApp_ProcessEvent               205
     ?Subroutine0                           5
     PeopleApp_ProcessZDOMsgs             149
     ?Subroutine1                           3
     ??Subroutine2_0                        6
     PeopleApp_HandleKeys                 241
     PeopleApp_MessageMSGCB                45
     PeopleApp_Send_body_Message          352
     frameSeq                               1
     ??PeopleApp_Init?relay                 6
     ??PeopleApp_ProcessEvent?relay         6
     ??PeopleApp_ProcessZDOMsgs?relay       6
     ??PeopleApp_HandleKeys?relay           6
     ??PeopleApp_MessageMSGCB?relay         6
     ??PeopleApp_Send_body_Message?relay    6
     ?<Constant "PeopleApp">               10
     ?<Constant "rcvd">                     5

 
 1 129 bytes in segment BANKED_CODE
    36 bytes in segment BANK_RELAYS
     3 bytes in segment SFR_AN
    29 bytes in segment XDATA_ROM_C
    22 bytes in segment XDATA_Z
 
 1 165 bytes of CODE  memory
    29 bytes of CONST memory
     0 bytes of DATA  memory (+ 3 bytes shared)
    22 bytes of XDATA memory

Errors: none
Warnings: none
